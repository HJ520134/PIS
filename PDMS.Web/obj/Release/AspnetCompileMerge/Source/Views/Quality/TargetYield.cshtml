@{

    ViewBag.Edit = T("QA.Edit").Text;
    ViewBag.BillingPlanMaintenance = T("QA.BillingPlanMaintenance").Text;
    ViewBag.Enterpercentage = T("QA.Enterpercentage").Text;
    ViewBag.Successfullymodified = T("QA.Successfullymodified").Text;
    ViewBag.Imported = T("QA.Imported").Text;
    ViewBag.Updatecompleted = T("QA.Updatecompleted").Text;
}
<!-- Main content -->
<section class="content portal-content">
    <div class="row">
        <div class="col-md-12 col-lg-9">
            <h4 class="margin-td-5" id="js_search_keywords"></h4>
        </div>

        <div class="col-md-9">
            <label class="control-label" id="lblTitle"></label>
        </div>

        <div class="col-md-12 search-field col-lg-3">
            <a class="btn btn-primary btn-sm" data-toggle="modal" id="btn_back"><i class="fa fa-reply"></i>@T("QA.Return")</a>
        </div>
    </div>
    <hr class="hr-custom">

    <div class="row">
        <div class="col-xs-12" id="js_criteria_alert_cnt">
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <h4>@T("QA.Planmaintenance")<span id="js_input_date"></span></h4>
            @using (Html.BeginForm("ImportExcel", "Quality", FormMethod.Post, new { id = "js_form_excel_add" }))
            {
                <div class="row">
                    <div class="col-sm-6">
                        <div class=" pull-left">
                            <button type="button" class="fa fa-download btn btn-primary" id="js_btn_download_fl">@T("QA.Templatedownload")</button>
                            <button type="button" class="fa fa-download btn btn-primary" id="js_btn_download_currentWK">@T("QA.Templatedownloadweek")</button>
                            <button type="button" class="fa fa-upload btn btn-primary" id="js_btn_import_fl">@T("QA.Uploadplan")</button>
                            <button type="button" class="fa fa-upload btn btn-primary" id="js_btn_import_currentWK">@T("QA.Uploadplanweek")</button>
                        </div>
                    </div>

                    <div class="col-sm-6">
                        <div class=" pull-right">
                            <button type="button" class="fa fa-search btn btn-primary" id="js_btn_searchthisWorkPlan">@T("QA.Viewthisweekplan")</button>
                            <button type="button" class="fa fa-search btn btn-primary" id="js_btn_searchNextWorkPlan">@T("QA.Viewnextweekplan")</button>
                        </div>
                    </div>

                </div>
            }
            <br />
        </div>
    </div>
    <!--內容 表格列-->
    <div class="row">
        <!--表格-->
        @using (Html.BeginForm("DataTableExec", "Quality", FormMethod.Post, new { id = "js_form_datatable_exec" }))
        {
            <div class="col-md-12 table-container">
                <table class="table table-striped table-hover table-condensed nowrap" id="js_Plan_datatable">
                    <thead>
                        <tr>
                            <th class="table-col-action nosort">@T("Common.Action")</th>
                            <th class="table-col-seq nosort">@T("Common.Seq")</th>
                            <th>@T("QA.Checkpointname")</th>
                            <th>@T("QA.Colour")</th>
                            <th>@T("QA.Monday")<br />@T("QA.Atargetyield")</th>
                            <th>@T("QA.Monday")<br />@T("QA.Secondarytargetyield")</th>
                            <th>@T("QA.Tuesday")<br />@T("QA.Atargetyield")</th>
                            <th>@T("QA.Tuesday")<br />@T("QA.Secondarytargetyield")</th>
                            <th>@T("QA.Wednesday")<br />@T("QA.Atargetyield")</th>
                            <th>@T("QA.Wednesday")<br />@T("QA.Secondarytargetyield")</th>
                            <th>@T("QA.Thursday")<br />@T("QA.Atargetyield")</th>
                            <th>@T("QA.Thursday")<br />@T("QA.Secondarytargetyield")</th>
                            <th>@T("QA.Friday")<br />@T("QA.Atargetyield")</th>
                            <th>@T("QA.Friday")<br />@T("QA.Secondarytargetyield")</th>
                            <th>@T("QA.Saturday")<br />@T("QA.Atargetyield")</th>
                            <th>@T("QA.Saturday")<br />@T("QA.Secondarytargetyield")</th>
                            <th>@T("QA.Sunday")<br />@T("QA.Atargetyield")</th>
                            <th>@T("QA.Sunday")<br />@T("QA.Secondarytargetyield")</th>
                        </tr>
                    </thead>

                </table>
                <div id="page" class="row" hidden="hidden"></div>

            </div><!--/表格-->
        }
    </div><!-- / 內容 表格列 -->


</section><!-- /.content -->
<!-- /.content -->

@section ViewModals{

    <div class="modal fade" id="js_edit_modal" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">@T("QA.Processinformationeditpage")</h4>
                </div>
                @using (Html.BeginForm("EditFLDetailInfo", "Quality", FormMethod.Post, new { id = "js_form_edit_fl" }))
                {
                    <div class="modal-body form-horizontal">
                        <div class="row">
                            <input type="hidden" id="js_edit_modal_Master_UID" name="FlowChart_Master_UID" />
                            <input type="hidden" id="js_edit_modal_date" name="Product_Date" />
                            <input type="hidden" id="js_edit_modal_Process_seq" name="Process_seq" />
                            <input type="hidden" id="js_edit_modal_Detail_UID" name="FlowChart_Detail_UID" />

                            <div class="form-group col-xs-12 col-md-4 col-lg-4">
                                <label class="col-sm-5 control-label" for="s_input_Process">@T("QA.Checkpointname")</label>
                                <div class="col-sm-7">
                                    <input type="text" disabled="disabled" class="form-control input-sm required" id="Process" name="Process">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-4 col-lg-4">
                                <label class="col-sm-5 control-label" for="s_input_Process">@T("QA.Colour")</label>
                                <div class="col-sm-7">
                                    <input type="text" disabled="disabled" class="form-control input-sm required" id="Color" name="Color">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_MondayQAFirstRejectionRate">@T("QA.Atargetyield")@T("QA.Monday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="MondayQAFirstRejectionRate" name="MondayQAFirstRejectionRate" placeholder="@T("QA.Atargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseenteratargetyield")"
                                           data-rule-digits="true">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_MondayQASecondRejectionRate">@T("QA.Secondarytargetyield")@T("QA.Monday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="MondayQASecondRejectionRate" name="MondayQASecondRejectionRate" placeholder="@T("QA.Secondarytargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseentersecondarytargetyield")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_TuesdayProduct_Plan">@T("QA.Atargetyield")@T("QA.Tuesday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="TuesdayQAFirstRejectionRate" name="TuesdayQAFirstRejectionRate" placeholder="@T("QA.Atargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseenteratargetyield")"
                                           data-rule-digits="true" data-msg-digits="">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_TuesdayQASecondRejectionRate">@T("QA.Secondarytargetyield")@T("QA.Tuesday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="TuesdayQASecondRejectionRate" name="TuesdayQASecondRejectionRate" placeholder="@T("QA.Secondarytargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseentersecondarytargetyield")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_WednesdayQAFirstRejectionRate">@T("QA.Atargetyield")@T("QA.Wednesday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="WednesdayQAFirstRejectionRate" name="WednesdayQAFirstRejectionRate" placeholder="@T("QA.Atargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseenteratargetyield")"
                                           data-rule-digits="true" data-msg-digits="">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_WednesdayQASecondRejectionRate">@T("QA.Secondarytargetyield")@T("QA.Wednesday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="WednesdayQASecondRejectionRate" name="WednesdayQASecondRejectionRate" placeholder="@T("QA.Secondarytargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseentersecondarytargetyield")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_ThursdayQAFirstRejectionRate">@T("QA.Atargetyield")@T("QA.Thursday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="ThursdayQAFirstRejectionRate" name="ThursdayQAFirstRejectionRate" placeholder="@T("QA.Atargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseenteratargetyield")"
                                           data-rule-digits="true" data-msg-digits="">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_ThursdayQASecondRejectionRate">@T("QA.Secondarytargetyield")@T("QA.Thursday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="ThursdayQASecondRejectionRate" name="ThursdayQASecondRejectionRate" placeholder="@T("QA.Secondarytargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseentersecondarytargetyield")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_FridayQAFirstRejectionRate">@T("QA.Atargetyield")@T("QA.Friday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="FridayQAFirstRejectionRate" name="FridayQAFirstRejectionRate" placeholder="@T("QA.Atargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseenteratargetyield")"
                                           data-rule-digits="true" data-msg-digits="">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_FridayQASecondRejectionRate">@T("QA.Secondarytargetyield")@T("QA.Friday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="FridayQASecondRejectionRate" name="FridayQASecondRejectionRate" placeholder="@T("QA.Secondarytargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseentersecondarytargetyield")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_SaterdayQAFirstRejectionRate">@T("QA.Atargetyield")@T("QA.Saturday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="SaterdayQAFirstRejectionRate" name="SaterdayQAFirstRejectionRate" placeholder="@T("QA.Atargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseenteratargetyield")"
                                           data-rule-digits="true" data-msg-digits="">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_SaterdayQASecondRejectionRate">@T("QA.Secondarytargetyield")@T("QA.Saturday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="SaterdayQASecondRejectionRate" name="SaterdayQASecondRejectionRate" placeholder="@T("QA.Secondarytargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseentersecondarytargetyield")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_SundayQAFirstRejectionRate">@T("QA.Atargetyield")@T("QA.Sunday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="SundayQAFirstRejectionRate" name="SundayQAFirstRejectionRate" placeholder="@T("QA.Atargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseenteratargetyield")"
                                           data-rule-digits="true" data-msg-digits="">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_SundayQASecondRejectionRate">@T("QA.Secondarytargetyield")@T("QA.Sunday")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="SundayQASecondRejectionRate" name="SundayQASecondRejectionRate" placeholder="@T("QA.Secondarytargetyield")"
                                           data-rule-required="true" data-msg-required="@T("QA.Pleaseentersecondarytargetyield")">
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <div class="col-sm-12">
                                <div class=" pull-right">
                                    <button class="btn btn-primary btn-sm" data-dismiss="modal" id="btn_save_edit"><i class="fa fa-times"></i>@T("QA.Submit")</button>
                                </div>
                            </div>
                        </div>


                    </div>
                    <!--jquery validata error container-->
                    <div class="col-xs-12"><ul class="list-group validate-error"></ul></div>
                }
            </div>
        </div>

    </div>
}

<!--更新Excel Start-->
<div class="modal fade" id="js_importExcel_modal" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">@T("QA.Uploadplanandtargetyield")</h4>
            </div>
            @using (Html.BeginForm("ImportPlanExcel", "Quality", FormMethod.Post, new { enctype = "multipart/form-data", id = "js_form_excel_update" }))
            {
                <div class="modal-body">
                    <div class="row">
                        <div class="col-sm-2">
                            <label class="control-label" for="js_s_input_import">@T("QA.SelectscheduledExcelfile")</label>
                        </div>
                        <div class="col-sm-8">
                            <input type="file" class="form-control" id="js_s_input_import" name="upload_excel" placeholder="@T("QA.SelecttheExcelfile")"
                                   required data-msg-required="@T("QA.PleaseselectExcelfile")" />
                        </div>
                    </div>
                    <input type="hidden" id="hid_key" name="FlowChart_Master_UID" value=@ViewBag.FlowChart_Master_UID />
                    <input type="hidden" id="hid_currentOrNextWeek" name="hid_currentOrNextWeek" />
                </div>

                <div class="modal-footer">
                    <button type="button" class="fa fa-upload btn btn-primary" id="js_btn_clear_Update">@T("QA.Cancel")</button>
                    <button type="button" class="fa fa-download btn btn-primary" id="js_btn_excel_update">@T("QA.Submit")</button>
                </div>
            }
        </div>
    </div>
</div>
<!--更新Excel End-->

@section ViewScripts{
    <script type="text/javascript">
        $(function () {
            var _getDate=function(SearchThisWeek){
                var url = QATargetYield.urls.GetDateTime;
                $.post(url,{IsThisWork:SearchThisWeek}, function (data)
                {
                    document.getElementById('js_input_date').innerHTML=data;
                });
            }
            var QATargetYield = (function () {
                var urls = {
                    SearchPlanData: '@Url.Action("QueryQATargetYield", "Quality")',
                    QueryProcessMGDataSingle: '@Url.Action("QueryQAProcessMGDataSingle", "Quality")',
                    ModifyProcessMGData:'@Url.Action("ModifySingleQaTargetYield", "Quality")',
                    backFL: '@Url.Action("QAFlowChartList", "Quality")',
                    GetDateTime:'@Url.Action("GetDateTime", "Quality")',
                };
                var contentDatatable = null;
                //region
                var columns = [
                    {
                        data:null,
                        createdCell: function (td, cellData, rowData, row, col) {
                            var buttonEdit = '<button type="button" class="btn btn-default btn-sm js-grid-edit" data-id="' + rowData.FlowChart_Master_UID + '"   data-DetailId="' + rowData.Flowchart_Detail_UID + '">@ViewBag.Edit</button>';
                            $(td).html(buttonEdit);
                        },
                        className: "text-center"
                    }, {
                        data: "Process_seq",
                        className: "min-col-xs"
                    }, {
                        data: "Process",
                        className: "min-col-xs"
                    },
                     {
                         data: "Color",
                         className: "min-col-xs"
                     },
                    {
                        data: "MondayQAFirstRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "MondayQASecondRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "TuesdayQAFirstRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "TuesdayQASecondRejectionRate",
                        className: "min-col-xs text-center",
                    }, {
                        data: "WednesdayQAFirstRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "WednesdayQASecondRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "ThursdayQAFirstRejectionRate",
                        className: "min-col-xs text-center",
                    }, {
                        data: "ThursdayQASecondRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "FridayQAFirstRejectionRate",
                        className: "min-col-xs text-center",
                    }, {
                        data: "FridayQASecondRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "SaterdayQAFirstRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "SaterdayQASecondRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "SundayQAFirstRejectionRate",
                        className: "min-col-xs",
                    }, {
                        data: "SundayQASecondRejectionRate",
                        className: "min-col-xs",
                    }];
                //endregion
                var _getParams = function (SearchThisWeek) {
                    return { Flowchart_Master_UID: @ViewBag.Flowchart_Master_UID,IsThisWork: SearchThisWeek };
                };
                var _queryFLS = function (SearchThisWeek) {

                    var config1 = {
                        pageId: "#page",
                        tableId: "#js_Plan_datatable",
                        remoteUrl: urls.SearchPlanData,
                        searchParams: _getParams(SearchThisWeek),
                        tableOptions: {
                            scrollX: true,
                            autoWidth: true,
                            columns: columns
                        }
                    };
                    var config2 = {
                        pageId: "#page",
                        tableId: "#js_Plan_datatable",
                        remoteUrl: urls.SearchPlanData,
                        searchParams: _getParams(SearchThisWeek),
                        tableOptions: {
                            scrollX: true,
                            autoWidth: true,
                            columns: columns
                        }
                    };
                    if(SearchThisWeek)
                    {
                        PDMS.Utility.Pages.Set(config1);
                    }
                    else
                    {
                        PDMS.Utility.Pages.Set(config2);
                    }
                };
                var SetTitle=function()
                {
                    var title = '@ViewBag.CustomerName' + ' ' + '@ViewBag.ProjectName' + ' ' + '@ViewBag.PartTypes' + ' ' + '@ViewBag.ProductPhase' + '@ViewBag.BillingPlanMaintenance'
                    $('#lblTitle').text(title);
                };
                return {
                    urls: urls,
                    Init: function () {
                        $('#page').page('destroy');
                        _getDate(true);
                        var uiNextBtn =document.getElementById("js_btn_searchNextWorkPlan");
                        uiNextBtn.disabled=false;
                        var uiThisBtn =document.getElementById("js_btn_searchthisWorkPlan");
                        uiThisBtn.disabled=true;
                        _queryFLS(true);
                        SetTitle();
                    },
                    QueryFlowChartNextPlan: function () {

                        $('#page').page('destroy');
                        _getDate(false);
                        var uiNextBtn =document.getElementById("js_btn_searchNextWorkPlan");
                        uiNextBtn.disabled=true;
                        var uiThisBtn =document.getElementById("js_btn_searchthisWorkPlan");
                        uiThisBtn.disabled=false;

                        _queryFLS(false);
                        SetTitle();
                    },
                    GetDataTables: function () {
                        if (contentDatatable == null) {
                            contentDatatable = $('#js_Plan_datatable').DataTable({
                                paging: false,
                                searching: false,
                                ordering: false,
                                retrieve: true,
                                columns: columns,
                            });
                        }
                        return contentDatatable;
                    }
                }
            })();
            QATargetYield.Init();
            $('#btn_back').on('click', function () {
                var url = QATargetYield.urls.backFL;
                window.location.href = url;
            });
            jQuery.validator.addMethod("percent", function (value, element) {
                var reg = /^((\d+\.?\d*)|(\d*\.\d+))\%$/;
                var result = reg.test(value);
                return result;
            }, "@ViewBag.Enterpercentage");
            $('#js_btn_searchthisWorkPlan').on('click',function()
            {
                QATargetYield.Init();
            });
            $('#js_btn_searchNextWorkPlan').on('click',function()
            {
                QATargetYield.QueryFlowChartNextPlan();
            });
            //#region  div弹出编辑画面
            //#region 点击DataTable弹出div并加载信息
            $('body').on('click', '.js-grid-edit', function () {
                var Flowchart_Master_UID = $(this).attr('data-id');
                $('#js_edit_modal_Master_UID').val(Flowchart_Master_UID);
                var Flowchart_Detail_UID=$(this).attr('data-DetailId');
                var uiThisBtn =document.getElementById("js_btn_searchthisWorkPlan");
                $.get(QATargetYield.urls.QueryProcessMGDataSingle, {Flowchart_Master_UID:Flowchart_Master_UID, Flowchart_Detail_UID:Flowchart_Detail_UID,IsThisWork:uiThisBtn.disabled }, function (data) {
                    $('#Process').val(data.Process);
                    $('#Color').val(data.Color);
                    $('#js_edit_modal_date').val(data.Product_Date);
                    $('#js_edit_modal_Process_seq').val(data.Process_seq);
                    $('#js_edit_modal_Detail_UID').val(data.Flowchart_Detail_UID);
                    $('#MondayQAFirstRejectionRate').val(data.MondayQAFirstRejectionRate);
                    $('#MondayQASecondRejectionRate').val(data.MondayQASecondRejectionRate);
                    $('#TuesdayQAFirstRejectionRate').val(data.TuesdayQAFirstRejectionRate);
                    $('#TuesdayQASecondRejectionRate').val(data.TuesdayQASecondRejectionRate);
                    $('#WednesdayQAFirstRejectionRate').val(data.WednesdayQAFirstRejectionRate);
                    $('#WednesdayQASecondRejectionRate').val(data.WednesdayQASecondRejectionRate);
                    $('#ThursdayQAFirstRejectionRate').val(data.ThursdayQAFirstRejectionRate);
                    $('#ThursdayQASecondRejectionRate').val(data.ThursdayQASecondRejectionRate);
                    $('#FridayQAFirstRejectionRate').val(data.FridayQAFirstRejectionRate);
                    $('#FridayQASecondRejectionRate').val(data.FridayQASecondRejectionRate);
                    $('#SaterdayQAFirstRejectionRate').val(data.SaterdayQAFirstRejectionRate);
                    $('#SaterdayQASecondRejectionRate').val(data.SaterdayQASecondRejectionRate);
                    $('#SundayQAFirstRejectionRate').val(data.SundayQAFirstRejectionRate);
                    $('#SundayQASecondRejectionRate').val(data.SundayQASecondRejectionRate);
                    //#region 设置是否可以修改
                    document.getElementById("MondayQAFirstRejectionRate").disabled=false;
                    document.getElementById("MondayQASecondRejectionRate").disabled=false;
                    document.getElementById("TuesdayQAFirstRejectionRate").disabled=false;
                    document.getElementById("TuesdayQASecondRejectionRate").disabled=false;
                    document.getElementById("WednesdayQAFirstRejectionRate").disabled=false;
                    document.getElementById("WednesdayQASecondRejectionRate").disabled=false;
                    document.getElementById("ThursdayQAFirstRejectionRate").disabled=false;
                    document.getElementById("ThursdayQASecondRejectionRate").disabled=false;
                    document.getElementById("FridayQAFirstRejectionRate").disabled=false;
                    document.getElementById("FridayQASecondRejectionRate").disabled=false;
                    document.getElementById("SaterdayQAFirstRejectionRate").disabled=false;
                    document.getElementById("SaterdayQASecondRejectionRate").disabled=false;
                    document.getElementById("SundayQAFirstRejectionRate").disabled=false;
                    document.getElementById("SundayQASecondRejectionRate").disabled=false;
                    if(uiThisBtn.disabled)
                    {
                        var dateNow=new Date();
                        if(dateNow.getDay()==6)
                        {
                            document.getElementById("MondayQAFirstRejectionRate").disabled=true;
                            document.getElementById("MondayQASecondRejectionRate").disabled=true;
                            document.getElementById("TuesdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("TuesdayQASecondRejectionRate").disabled=true;
                            document.getElementById("WednesdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("WednesdayQASecondRejectionRate").disabled=true;
                            document.getElementById("ThursdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("ThursdayQASecondRejectionRate").disabled=true;
                            document.getElementById("FridayQAFirstRejectionRate").disabled=true;
                            document.getElementById("FridayQASecondRejectionRate").disabled=true;
                            document.getElementById("SaterdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SaterdayQASecondRejectionRate").disabled=false;
                            document.getElementById("SundayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SundayQASecondRejectionRate").disabled=false;
                        }
                        if(dateNow.getDay()==5)
                        {
                            document.getElementById("MondayQAFirstRejectionRate").disabled=true;
                            document.getElementById("MondayQASecondRejectionRate").disabled=true;
                            document.getElementById("TuesdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("TuesdayQASecondRejectionRate").disabled=true;
                            document.getElementById("WednesdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("WednesdayQASecondRejectionRate").disabled=true;
                            document.getElementById("ThursdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("ThursdayQASecondRejectionRate").disabled=true;
                            document.getElementById("FridayQAFirstRejectionRate").disabled=false;
                            document.getElementById("FridayQASecondRejectionRate").disabled=false;
                            document.getElementById("SaterdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SaterdayQASecondRejectionRate").disabled=false;
                            document.getElementById("SundayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SundayQASecondRejectionRate").disabled=false;
                        }
                        if(dateNow.getDay()==4)
                        {
                            document.getElementById("MondayQAFirstRejectionRate").disabled=true;
                            document.getElementById("MondayQASecondRejectionRate").disabled=true;
                            document.getElementById("TuesdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("TuesdayQASecondRejectionRate").disabled=true;
                            document.getElementById("WednesdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("WednesdayQASecondRejectionRate").disabled=true;
                            document.getElementById("ThursdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("ThursdayQASecondRejectionRate").disabled=false;
                            document.getElementById("FridayQAFirstRejectionRate").disabled=false;
                            document.getElementById("FridayQASecondRejectionRate").disabled=false;
                            document.getElementById("SaterdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SaterdayQASecondRejectionRate").disabled=false;
                            document.getElementById("SundayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SundayQASecondRejectionRate").disabled=false;
                        }
                        if(dateNow.getDay()==3)
                        {
                            document.getElementById("MondayQAFirstRejectionRate").disabled=true;
                            document.getElementById("MondayQASecondRejectionRate").disabled=true;
                            document.getElementById("TuesdayQAFirstRejectionRate").disabled=true;
                            document.getElementById("TuesdayQASecondRejectionRate").disabled=true;
                            document.getElementById("WednesdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("WednesdayQASecondRejectionRate").disabled=false;
                            document.getElementById("ThursdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("ThursdayQASecondRejectionRate").disabled=false;
                            document.getElementById("FridayQAFirstRejectionRate").disabled=false;
                            document.getElementById("FridayQASecondRejectionRate").disabled=false;
                            document.getElementById("SaterdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SaterdayQASecondRejectionRate").disabled=false;
                            document.getElementById("SundayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SundayQASecondRejectionRate").disabled=false;
                        }
                        if(dateNow.getDay()==2)
                        {
                            document.getElementById("MondayQAFirstRejectionRate").disabled=true;
                            document.getElementById("MondayQASecondRejectionRate").disabled=true;
                            document.getElementById("TuesdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("TuesdayQASecondRejectionRate").disabled=false;
                            document.getElementById("WednesdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("WednesdayQASecondRejectionRate").disabled=false;
                            document.getElementById("ThursdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("ThursdayQASecondRejectionRate").disabled=false;
                            document.getElementById("FridayQAFirstRejectionRate").disabled=false;
                            document.getElementById("FridayQASecondRejectionRate").disabled=false;
                            document.getElementById("SaterdayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SaterdayQASecondRejectionRate").disabled=false;
                            document.getElementById("SundayQAFirstRejectionRate").disabled=false;
                            document.getElementById("SundayQASecondRejectionRate").disabled=false;
                        }
                    }
                    //#endregion
                });
                $('#js_edit_modal').modal('show');
            });
            //#endregion 点击DataTable弹出div并加载信息
            //#region 保存单笔修改的信息
            $('#btn_save_edit').on('click', function () {
                var submitJson = $('#js_form_edit_fl').serializeObject();
                $.post(QATargetYield.urls.ModifyProcessMGData, { jsonWithData: JSON.stringify(submitJson) }, function (data) {
                    if (data == 'SUCCESS') {
                        PDMS.Utility.MessageBox.info("@ViewBag.Successfullymodified");
                        $('#js_form_edit_fl').modal('hide');
                        var uiThisBtn =document.getElementById("js_btn_searchthisWorkPlan");
                        if(uiThisBtn.disabled)
                        {
                            QATargetYield.Init();
                        }
                        else
                        {
                            QATargetYield.QueryFlowChartNextPlan();
                        }
                    } else {
                        PDMS.Utility.MessageBox.error(data);
                    }
                });
            });
            //#endregion 保存单笔修改的信息
            //隐藏modal框时清空值
            $('#js_edit_modal').on('hidden.bs.modal', function (e) {
                $('#js_edit_modal').find('input').val('');
                $('.list-group.validate-error').empty();
            });
            //#endregion 隐藏modal框时清空值
            //#endregion
            $('#js_btn_download_fl').on('click', function () {
                var url = '@Html.Raw(Url.Action("DownloadPlanExcel", "Quality", new { FlowChart_Master_UID = ViewBag.FlowChart_Master_UID, clintName = "js_btn_download_fl" }))';
                this.form.action = url;
                $('#js_form_excel_add').submit();
            });
            $('#js_btn_download_currentWK').on('click', function () {
                var url = '@Html.Raw(Url.Action("DownloadPlanExcel", "Quality", new { FlowChart_Master_UID = ViewBag.FlowChart_Master_UID, clintName = "js_btn_download_currentWK" }))';
                this.form.action = url;
                $('#js_form_excel_add').submit();
            });
            $('#js_btn_import_fl').on('click', function () {
                $('#hid_currentOrNextWeek').val('nextWeek');
                $('#js_importExcel_modal').modal('show');
            });
            $('#js_btn_import_currentWK').on('click', function () {
                $('#hid_currentOrNextWeek').val('currentWeek');
                $('#js_importExcel_modal').modal('show');
            });
            $('#js_btn_excel_update').on('click', function () {
                $.blockUI({ message: "<h1>@ViewBag.Imported </h1>" });
                $('#js_form_excel_update').ajaxSubmit({
                    beforeSubmit: function () {
                        if (!$('#js_form_excel_update').valid()) {
                            $.unblockUI();
                            return false;
                        }
                    },
                    success: function (data) {
                        $.unblockUI();
                        if (data != '') {
                            PDMS.Utility.MessageBox.info(data);
                        }
                        else {
                            $('#js_importExcel_modal').modal('hide');
                            PDMS.Utility.MessageBox.info('@ViewBag.Updatecompleted');
                            window.location.reload();
                        }
                    }
                });
            });
            $('#js_btn_clear_Update').click(function () {
                $('#js_s_input_import').val('');
            });
        });
    </script>
}