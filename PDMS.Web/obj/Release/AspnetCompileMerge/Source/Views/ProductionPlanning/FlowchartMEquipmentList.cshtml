@{ 
    ViewBag.Close = T("Common.Close").Text;
    ViewBag.Open = T("Common.Open").Text;
    ViewBag.Delete = T("Common.Delete").Text;
    ViewBag.Export = T("Common.Export").Text;
    ViewBag.View = T("Common.View").Text;
    ViewBag.Update = T("Common.Update").Text;
    ViewBag.Back = T("Common.Back").Text;
    ViewBag.Edit = T("Common.Edit").Text;

    ViewBag.MaintenanceEqip = T("Production.MaintenanceEqip").Text;
    ViewBag.JustInputPercent = T("Production.JustInputPercent").Text;
    ViewBag.MainEquipEditPage = T("Production.MainEquipEditPage").Text;
    ViewBag.AutoEquipEditPage = T("Production.AutoEquipEditPage").Text;
    ViewBag.Automation_Equipment = T("Production.Automation_Equipment").Text;


}

<section class="content portal-content">

    <!--次標題 與 搜尋-->
    <div class="row">
            <!--次標題與Search keyword-->
            <div class="col-md-12 col-lg-9">
                <h4 class="margin-td-5" id="js_search_keywords"></h4>
            </div><!-- /col-次標題與Search keyword -->
            <!--col-右方搜尋與功能按鈕列-->
            <div class="col-md-9">
                <label class="control-label" id="lblTitle"></label>
            </div>
            <div class="col-md-3 search-field col-lg-3">
                <button type="button" class="btn btn-primary btn-sm" id="btn_back"><i class="fa fa-reply"></i> @T("Common.Back")</button>
            </div><!-- /col-右方搜尋與功能按鈕列-->
        </div><!--/次標題 與 搜尋-->
        <hr class="hr-custom">

    <!--內容 表格列-->
<div>

  <!-- Nav tabs -->
  <ul class="nav nav-tabs" id="myTabs">
    <li class="active"><a href="#home"   data-toggle="tab">@T("Production.MainEquip")</a></li>
    <li><a href="#profile"  data-toggle="tab">@T("Production.Automation_Equipment")</a></li>
  </ul>

  <!-- Tab panes -->
  <div class="tab-content">
    <div class="tab-pane active" id="home">
        <div class="row">
            <!--表格-->
            <div class="col-md-12 table-container" id="js_saveall_datatables">
                <table class="table table-striped table-hover table-condensed nowrap" id="js_FL_datatable">
                    <thead>
                        <tr>
                            <th class="table-col-action nosort">@T("Common.Action")</th>
                            <th>@T("Production.Process_Seq")</th>
                            <th>@T("Production.Process_Station")</th>
                            <th>@T("QA.Functionfactory")</th>
                            <th>@T("QA.Processname")</th>
                            <th>@T("Production.EquipName")</th>
                            <th>@T("Production.PlanningCT")</th>
                            <th>@T("Production.NowCT")</th>
                            <th>@T("Production.Capacity_ByDay")</th>
                            <th>@T("Production.Capacity_ByHour")</th>
                            <th>@T("Production.Equip")</th>
                            <th>@T("Production.Ratio")</th>
                            <th>@T("Production.NeedNum")</th>
                            <th>@T("Production.NPINeedNUM")</th>
                            <th>@T("Production.MPNeedNUM")</th>
                        </tr>
                    </thead>
                    <tfoot>
                        <tr>
                            <th class="table-col-action nosort">@T("Common.Action")</th>
                            <th>@T("Production.Process_Seq")</th>
                            <th>@T("Production.Process_Station")</th>
                            <th>@T("QA.Functionfactory")</th>
                            <th>@T("QA.Processname")</th>
                            <th>@T("Production.EquipName")</th>
                            <th>@T("Production.PlanningCT")</th>
                            <th>@T("Production.NowCT")</th>
                            <th>@T("Production.Capacity_ByDay")</th>
                            <th>@T("Production.Capacity_ByHour")</th>
                            <th>@T("Production.Equip")</th>
                            <th>@T("Production.Ratio")</th>
                            <th>@T("Production.NeedNum")</th>
                            <th>@T("Production.NPINeedNUM")</th>
                            <th>@T("Production.MPNeedNUM")</th>
                        </tr>
                    </tfoot>
                </table>
                <div id="page" class="row"></div>

            </div><!--/表格-->
        </div>
        
    </div>
    <div class="tab-pane active" id="profile">
        <div class="row">
            <!--表格-->
            <div class="col-md-12 table-container" id="js_auto_datatables">
                <table class="table table-striped table-hover table-condensed nowrap" id="js_FL_Auto">
                    <thead>
                        <tr>
                            <th class="table-col-action nosort">@T("Common.Action")</th>
                            <th>@T("Production.Process_Seq")</th>
                            <th>@T("Production.Process_Station")</th>
                            <th>@T("QA.Functionfactory")</th>
                            <th>@T("QA.Processname")</th>
                            <th>@T("Production.EquipName")</th>
                            <th>@T("Production.PlanningCT")</th>
                            <th>@T("Production.NowCT")</th>
                            <th>@T("Production.Capacity_ByDay")</th>
                            <th>@T("Production.Capacity_ByHour")</th>
                            <th>@T("Production.Equip")</th>
                            <th>@T("Production.Ratio")</th>
                            <th>@T("Production.NeedNum")</th>
                            <th>@T("Production.NPINeedNUM")</th>
                            <th>@T("Production.MPNeedNUM")</th>
                        </tr>
                    </thead>
                    <tfoot>
                        <tr>
                            <th class="table-col-action nosort">@T("Common.Action")</th>
                            <th>@T("Production.Process_Seq")</th>
                            <th>@T("Production.Process_Station")</th>
                            <th>@T("QA.Functionfactory")</th>
                            <th>@T("QA.Processname")</th>
                            <th>@T("Production.EquipName")</th>
                            <th>@T("Production.PlanningCT")</th>
                            <th>@T("Production.NowCT")</th>
                            <th>@T("Production.Capacity_ByDay")</th>
                            <th>@T("Production.Capacity_ByHour")</th>
                            <th>@T("Production.Equip")</th>
                            <th>@T("Production.Ratio")</th>
                            <th>@T("Production.NeedNum")</th>
                            <th>@T("Production.NPINeedNUM")</th>
                            <th>@T("Production.MPNeedNUM")</th>
                        </tr>
                    </tfoot>
                </table>
                <div id="page2" class="row"></div>

            </div><!--/表格-->
        </div>
    </div>
  </div>

</div>

    
</section>

@section ViewModals{

    <div class="modal fade" id="js_edit_modal" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">@T("Production.MainEquipEditPage")</h4>
                </div>
                @using (Html.BeginForm("EditFLEquipmentInfo", "FlowChart", FormMethod.Post, new { id = "js_form_edit_fl" }))
                {
                    <div class="modal-body form-horizontal">
                        <div class="row">
                            <input type="hidden" id="FlowChart_Detail_UID" name="FlowChart_Detail_UID" />
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_ProcessStation">@T("Production.Process_Station")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm required" id="s_input_ProcessStation" readonly name="Process_Station" placeholder="@T("Production.Process_Station")"
                                           required data-msg-required="@T("Production.InputProcess_Station")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_FunPlant">@T("QA.Functionfactory")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm required auto" id="s_input_FunPlant" readonly name="FunPlant" placeholder="@T("QA.Functionfactory")"
                                           required data-msg-required="@T("Production.InputFunPlant")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Process">@T("QA.Processname")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm required" id="s_input_Process" readonly name="Process" placeholder="@T("QA.Processname")"
                                           required data-msg-required="@T("Production.InputProcessname")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Capacity_ByDay">@T("Production.Capacity_ByDay")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Capacity_ByDay" readonly name="Capacity_ByDay" data-rule-number="true" data-msg-number="@T("Production.InputCapacity_ByDayNUM")" placeholder="@T("Production.Capacity_ByDay")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Equipment_Name">@T("Production.EquipName")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Equipment_Name" name="Equipment_Name" required data-msg-required="@T("Production.InputEquipName")" placeholder="@T("Production.EquipName")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Plan_CT">@T("Production.PlanningCT")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Plan_CT" name="Plan_CT" required data-rule-number="true" data-msg-number="@T("Production.InputPlanningCTNUM")" placeholder="@T("Production.PlanningCT")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Current_CT">@T("Production.NowCT")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Current_CT" name="Current_CT" data-rule-number="true" data-msg-number="@T("Production.InputNowCTNUM")" placeholder="@T("Production.NowCT")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Ratio">@T("Production.Ratio")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Ratio" name="Ratio" required data-rule-number="true" data-msg-number="@T("Production.InputRatioNum")" placeholder="@T("Production.Ratio")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_NPI_CurrentQty">@T("Production.NPINeedNUM")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_NPI_CurrentQty" name="NPI_CurrentQty" data-rule-number="true" data-msg-number=">@T("Production.InputNPINeedNUM")"  placeholder="@T("Production.NPINeedNUM")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_MP_CurrentQty">@T("Production.MPNeedNUM")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_MP_CurrentQty" name="MP_CurrentQty" data-rule-number="true" data-msg-number="@T("Production.InputMPNeedNUM")"  placeholder="@T("Production.MPNeedNUM")">
                                </div>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <div class="col-sm-12">
                                <div class="pull-right">
                                    <button class="btn btn-primary btn-sm" data-dismiss="modal"><i class="fa fa-times"></i> @T("Common.Cancel")</button>
                                    <button type="button" class="btn btn-primary btn-sm" id="btn_save_edit"><i class="fa fa-save"></i> @T("Common.Save")</button>
                                </div>
                            </div>
                        </div>


                    </div>
                    <input type="hidden" id="EquipmentUID" name="Flowchart_Detail_ME_Equipment_UID"/>
                    <!--jquery validata error container-->
                        <div class="col-xs-12"><ul class="list-group validate-error"></ul></div>

                }
            </div>
        </div>

    </div>

    <div class="modal fade" id="js_edit_automodal" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">@T("Production.AutoEquipEditPage")</h4>
                </div>
                @using (Html.BeginForm("EditFLEquipmentInfo", "FlowChart", FormMethod.Post, new { id = "js_form_autoedit_fl" }))
                {
                    <div class="modal-body form-horizontal">
                        <div class="row">
                            <input type="hidden" id="FlowChart_Detail_UID" name="FlowChart_Detail_UID" />
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_ProcessStation">@T("Production.Process_Station")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm required" id="s_input_ProcessStation_Two" readonly name="Process_Station" placeholder="@T("Production.Process_Station")"
                                           required data-msg-required="@T("Production.InputProcess_Station")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_FunPlant">@T("QA.Functionfactory")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm required" id="s_input_FunPlant_Auto" readonly name="FunPlant" placeholder="@T("QA.Functionfactory")"
                                           required data-msg-required="@T("Production.InputFunPlant")">
                                </div>
                            </div>
                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Process">@T("QA.Processname")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm required" id="s_input_Process_Auto" readonly name="Process" placeholder="@T("QA.Processname")"
                                           required data-msg-required="@T("Production.InputProcessname")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Capacity_ByDay">@T("Production.Capacity_ByDay")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Capacity_ByDay_Auto" readonly name="Capacity_ByDay" data-rule-number="true" data-msg-number="@T("Production.InputCapacity_ByDayNUM")" placeholder="@T("Production.Capacity_ByDay")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Equipment_Name">@T("Production.EquipName")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Equipment_Name_Auto" name="Equipment_Name" required data-msg-required="@T("Production.InputEquipName")" placeholder="@T("Production.EquipName")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Plan_CT">@T("Production.PlanningCT")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Plan_CT_Auto" name="Plan_CT" required data-rule-number="true" data-msg-number="@T("Production.InputPlanningCTNUM")" placeholder="@T("Production.PlanningCT")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Current_CT">@T("Production.NowCT")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Current_CT_Auto" name="Current_CT" data-rule-number="true" data-msg-number="@T("Production.NowCT")" placeholder="@T("Production.NowCT")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_Ratio">@T("Production.Ratio")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_Ratio_Auto" name="Ratio" required data-rule-number="true" data-msg-number="@T("Production.InputRatioNum")" placeholder="@T("Production.Ratio")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_NPI_CurrentQty_Auto">@T("Production.NPINeedNUM")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_NPI_CurrentQty_Auto" name="NPI_CurrentQty" data-rule-number="true" data-msg-number="@T("Production.InputNPINeedNUM")"  placeholder="@T("Production.NPINeedNUM")">
                                </div>
                            </div>

                            <div class="form-group col-xs-12 col-md-6 col-lg-6">
                                <label class="col-sm-5 control-label" for="s_input_MP_CurrentQty_Auto">@T("Production.MPNeedNUM")</label>
                                <div class="col-sm-7">
                                    <input type="text" class="form-control input-sm" id="s_input_MP_CurrentQty_Auto" name="MP_CurrentQty" data-rule-number="true" data-msg-number="@T("Production.InputMPNeedNUM")"  placeholder="@T("Production.MPNeedNUM")">
                                </div>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <div class="col-sm-12">
                                <div class="pull-right">
                                    <button class="btn btn-primary btn-sm" data-dismiss="modal"><i class="fa fa-times"></i> @T("Common.Cancel")</button>
                                    <button type="button" class="btn btn-primary btn-sm" id="btn_save_autoedit"><i class="fa fa-save"></i> @T("Common.Save")</button>
                                </div>
                            </div>
                        </div>


                    </div>
                    <input type="hidden" id="AutoEquipmentUID" name="Flowchart_Detail_ME_Equipment_UID"/>
                    <!--jquery validata error container-->
                        <div class="col-xs-12"><ul class="list-group validate-error"></ul></div>

                }
            </div>
        </div>

    </div>
}


@section ViewScripts{
    <script type="text/javascript">
        $(function () {
            var Equipment = (function () {
                var urls = {
                    queryFLS: '@Html.Raw(Url.Action("QueryFLMEEquipmentDetailList", "ProductionPlanning", new { id=ViewBag.ID,Version=ViewBag.Version,Param=1 }))',
                    queryFLSTwo: '@Html.Raw(Url.Action("QueryFLMEEquipmentDetailList", "ProductionPlanning", new { id=ViewBag.ID,Version=ViewBag.Version,Param=2 }))',
                    backFL: '@Url.Action("ProductionPlanningList", "ProductionPlanning")',
                    queryFLDetail: '@Url.Action("QueryFLDetailByID","FlowChart")',
                    SaveFLDetail: '@Html.Raw(Url.Action("EditFLEquipmentInfo", "ProductionPlanning", new { id=ViewBag.ID,Product_Phase = ViewBag.Product_Phase, Version=ViewBag.Version}))',
                    SaveAllDetail: '@Url.Action("SaveAllDetailInfo","FlowChart")'
                };

                var contentDatatable = null;
                var columns = [
                {
                     createdCell: function (td, cellData, rowData, row, col) {


                    var hiddenHtml = '<input type="hidden" name="cktrans" value=' + rowData.Flowchart_Detail_ME_UID + '>';
                    var buttonEdit = '<button type="button" class="btn btn-default btn-sm" data-id="' + rowData.Flowchart_Detail_ME_Equipment_UID + '">@ViewBag.Edit</button>';
                    var result = '<button type="button" class="btn btn-default" rel="action-popover">' +
                        '<i class="fa fa-reorder"></i>' +
                        '</button>' +
                        '<div class="hidden popover-content">';

                    var phase = '@ViewBag.Product_Phase';
                            result = hiddenHtml + buttonEdit;
                            $(td).html(result);
                     },
                    className:"text-center js-grid-edit"
                }, {
                    data: "Process_Seq",
                    className: "min-col-xs text-right"
                }, {
                    data: "Process_Station",
                    className: "min-col-xs Process_Station"
                },{
                    data: "FunPlant",
                    className: "min-col-xs"
                },{
                    data: "Process",
                    className: "min-col-xs"
                }, {
                    data: "Equipment_Name",
                    className: "min-col-xs"
                }, {
                    data: "Plan_CT",
                    className: "min-col-xs text-right"
                }, {
                    data: "Current_CT",
                    className: "min-col-xs text-right"
                },{
                    data: "Capacity_ByDay",
                    className: "min-col-xs text-right"
                },{
                    data: "Capacity_ByHour",
                    className: "min-col-xs text-right"
                }
                ,{
                    data: "Equipment_RequstQty",
                    className: "min-col-xs text-right"
                }
                , {
                    data: "Ratio",
                    className: "min-col-xs text-right",
                }
                , {
                    data: "RequestQty",
                    className: "min-col-xs text-right"
                }
                , {
                    data: "NPI_CurrentQty",
                    className: "min-col-xs text-right",
                }, {
                    data: "MP_CurrentQty",
                    className: "min-col-xs text-right",
                }
                ];

                var twocolumns = [
                {
                     createdCell: function (td, cellData, rowData, row, col) {


                    var hiddenHtml = '<input type="hidden" name="cktrans" value=' + rowData.Flowchart_Detail_ME_UID + '>';
                    var buttonEdit = '<button type="button" class="btn btn-default btn-sm" data-id="' + rowData.Flowchart_Detail_ME_Equipment_UID + '">@ViewBag.Edit</button>';
                    var result = '<button type="button" class="btn btn-default" rel="action-popover">' +
                        '<i class="fa fa-reorder"></i>' +
                        '</button>' +
                        '<div class="hidden popover-content">';

                    var phase = '@ViewBag.Product_Phase';
                    result = hiddenHtml + buttonEdit;
                    $(td).html(result);

                     },
                    className:"text-center js-grid-edit"
                }, {
                    data: "Process_Seq",
                    className: "min-col-xs text-right"
                }, {
                    data: "Process_Station",
                    className: "min-col-xs Process_Station"
                },{
                    data: "FunPlant",
                    className: "min-col-xs"
                },{
                    data: "Process",
                    className: "min-col-xs"
                }, {
                    data: "Equipment_Name",
                    className: "min-col-xs"
                }, {
                    data: "Plan_CT",
                    className: "min-col-xs text-right"
                }, {
                    data: "Current_CT",
                    className: "min-col-xs text-right"
                },{
                    data: "Capacity_ByDay",
                    className: "min-col-xs text-right"
                },{
                    data: "Capacity_ByHour",
                    className: "min-col-xs text-right"
                },
                {
                    data: "Equipment_RequstQty",
                    className: "min-col-xs text-right"
                }
                , {
                    data: "Ratio",
                    className: "min-col-xs text-right",
                }
                ,{
                    data: "RequestQty",
                    className: "min-col-xs text-right"
                }
                , {
                    data: "NPI_CurrentQty",
                    className: "min-col-xs text-right",
                }, {
                    data: "MP_CurrentQty",
                    className: "min-col-xs text-right",
                }
                ];

                var _queryFLS = function (firstLoad) {

                    var config = {
                        pageId: "#page",
                        tableId: "#js_FL_datatable",
                        remoteUrl: urls.queryFLS,

                        tableOptions: {
                            scrollX: true,
                            autoWidth: true,
                            //scrollCollapse: true,
                            paging: false,
                            //fixedColumns: true,
                            scrollY: 450,

                            columns: columns
                        }

                    };

                    var twoconfig = {
                        pageId: "#page2",
                        tableId: "#js_FL_Auto",
                        remoteUrl: urls.queryFLSTwo,
                        tableOptions: {
                            scrollX: true,
                            autoWidth: true,
                            //scrollCollapse: true,
                            paging: false,
                            //fixedColumns: true,
                            scrollY: 450,
                            columns: twocolumns
                        }
                    };


                    var chk_value = [];
                    table = PDMS.Utility.ReturnDataTable.Set(config, chk_value);
                    autotable = PDMS.Utility.ReturnDataTable.Set(twoconfig, chk_value);
                };


                return {
                    urls: urls,
                    Init: function () {
                        //$.blockUI({ message: "<h1>读取中，请稍后...</h1>" });
                        _queryFLS(true);
                        var title = '@ViewBag.CustomerName' + ' ' + '@ViewBag.ProjectName' + ' ' + '@ViewBag.PartTypes' + ' ' + '@ViewBag.ProductPhase' + '@ViewBag.MaintenanceEqip'
                        $('#lblTitle').text(title);
                        if(@ViewBag.CurrentTab == 1){
                            $('#myTabs a:first').tab('show')
                            $('#profile').hide();
                        }
                        else{
                            $('#myTabs a:last').tab('show')
                        }
                        //$.unblockUI();
                    },
                    QueryFLCharts: function () {
                        _queryFLS(false);
                    },
                    GetDataTables: function () {
                        if (contentDatatable == null) {
                            contentDatatable = $('#js_FL_datatable').DataTable({
                                paging: false,
                                searching: false,
                                ordering: false,
                                retrieve: true,
                                columns: columns,
                            });
                        }
                        return contentDatatable;
                    }
                }
            })();

            Equipment.Init();

            $('#js_form_edit_fl').validate({
                errorContainer: $('ul.validate-error'),
                errorLabelContainer: $('#js_edit_modal ul.validate-error'),
                wrapper: 'li'
            });

            $('#js_form_autoedit_fl').validate({
                errorContainer: $('ul.validate-error'),
                errorLabelContainer: $('#js_edit_automodal ul.validate-error'),
                wrapper: 'li'
            });


            $('#btn_back').on('click', function () {
                var url = Equipment.urls.backFL;
                window.location.href = url;
            });

            jQuery.validator.addMethod("percent", function (value, element) {
                var reg = /^((\d+\.?\d*)|(\d*\.\d+))\%$/;
                var result = reg.test(value);
                return result;
            }, "@ViewBag.JustInputPercent");

            //#region  div弹出编辑画面

            $('#js_FL_datatable tbody').on("click", ".js-grid-edit", function () {
                var tr = $(this).closest('tr');
                var row = table.row(tr).data();
                $('#js_edit_modal').modal('show');
                //标题
                $('#js_edit_modal').find('.modal-title').text(row.FunPlant + ' ' + row.Process + '@ViewBag.MainEquipEditPage');
                $('#s_input_ProcessStation').val(row.Process_Station);
                $('#s_input_FunPlant').val(row.FunPlant);
                $('#s_input_Process').val(row.Process);
                $('#s_input_Equipment_Name').val(row.Equipment_Name);
                $('#s_input_Plan_CT').val(row.Plan_CT);
                $('#s_input_Current_CT').val(row.Current_CT);
                $('#s_input_Capacity_ByDay').val(row.Capacity_ByDay);
                $('#s_input_Ratio').val(row.Ratio);
                $('#s_input_NPI_CurrentQty').val(row.NPI_CurrentQty);
                $('#s_input_MP_CurrentQty').val(row.MP_CurrentQty);
                $('#EquipmentUID').val(row.Flowchart_Detail_ME_Equipment_UID);

            });

            $('#js_FL_Auto tbody').on("click", ".js-grid-edit", function () {
                var tr = $(this).closest('tr');
                var row = autotable.row(tr).data();
                $('#js_edit_automodal').modal('show');
                //标题
                $('#js_edit_automodal').find('.modal-title').text(row.FunPlant + ' ' + row.Process + '@ViewBag.AutoEquipEditPage');
                $('#s_input_ProcessStation_Two').val(row.Process_Station);
                $('#s_input_FunPlant_Auto').val(row.FunPlant);
                $('#s_input_Process_Auto').val(row.Process);
                $('#s_input_Capacity_ByDay_Auto').val(row.Capacity_ByDay);
                $('#s_input_Equipment_Name_Auto').val(row.Equipment_Name);
                $('#s_input_Plan_CT_Auto').val(row.Plan_CT);
                $('#s_input_Current_CT_Auto').val(row.Current_CT);
                $('#s_input_Ratio_Auto').val(row.Ratio);
                $('#s_input_NPI_CurrentQty_Auto').val(row.NPI_CurrentQty);
                $('#s_input_MP_CurrentQty_Auto').val(row.MP_CurrentQty);
                $('#AutoEquipmentUID').val(row.Flowchart_Detail_ME_Equipment_UID);

            });

            $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            //e.target // newly activated tab
            if (e.target.innerHTML == '@ViewBag.Automation_Equipment') {
                $('#profile').show();
            }
            else {
                $('#profile').hide();
            }
            //e.relatedTarget // previous active tab
            });



            //#region 保存单笔修改的信息
            $('#btn_save_edit').on('click', function () {
                var url = Equipment.urls.SaveFLDetail;
                url = url + '&CurrentTab=1';
                this.form.action = url;
                $('#js_form_edit_fl').submit();
            });

            $('#btn_save_autoedit').on('click', function () {
                var url = Equipment.urls.SaveFLDetail;
                url = url + '&CurrentTab=2';
                this.form.action = url;
                $('#js_form_autoedit_fl').submit();
                $('#myTabs a:last').tab('show')
            });
            //#endregion 保存单笔修改的信息

            //隐藏modal框时清空值
            $('#js_edit_modal').on('hidden.bs.modal', function (e) {
                $('#js_edit_modal').find('input').val('');
                $('.list-group.validate-error').empty();
            });
            //#endregion 隐藏modal框时清空值

            //#endregion


        });
    </script>
}

