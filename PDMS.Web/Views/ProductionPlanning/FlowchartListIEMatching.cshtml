@{
    ViewBag.Edit = T("Common.Edit").Text;
    ViewBag.Pleasewait = T("QA.Pleasewait").Text;
    ViewBag.Naturalnumber = T("QA.Naturalnumber").Text;
    ViewBag.Submittedsuccessfully = T("QA.Submittedsuccessfully").Text;
    ViewBag.Savesuccessfully = T("QA.Savesuccessfully").Text;


    ViewBag.SetConfigProcess = T("Production.SetConfigProcess").Text;
    ViewBag.PeopleRadio = T("Production.PeopleRadio").Text;
    ViewBag.MachineRadio = T("Production.MachineRadio").Text; 
    ViewBag.ErrorForBadYieldDetail = T("Production.ErrorForBadYieldDetail").Text;
 }

<!-- Main content --> 

<section class="content portal-content">
    <!--次標題 與 搜尋-->
    <div class="row">
        <!--次標題與Search keyword-->
        <div class="col-md-12 col-lg-9">
            <input type="hidden" id="js_inputData_FlowChart_Master_UID" value=@ViewBag.FlowChart_Master_UID />
            <h4 class="margin-td-5" id="js_search_keywords"></h4>
        </div><!-- /col-次標題與Search keyword -->
        <!--col-右方搜尋與功能按鈕列-->
        <div class="col-md-12 search-field col-lg-3">
            <a class="btn btn-primary btn-sm" role="button" data-toggle="modal" onclick="javascript: self.location = document.referrer;"> @T("Common.Back")</a>
            <a class="btn btn-primary btn-sm" role="button" data-toggle="modal" id="js_btn_submit">
                 @T("QA.Submit")
            </a>
        </div>
    </div><!--/次標題 與 搜尋-->
    <hr class="hr-custom">
    <div class="row">
        <div class="col-xs-12" id="js_criteria_alert_cnt">
        </div>
    </div>
    <!--內容 表格列-->
    <div class="row">
        <!--表格-->
        <div class="col-md-12 table-container">
            <table class="table table-striped table-hover table-condensed nowrap" id="js_Flowchart_Detail_Data">
                <thead>
                    <tr>
                        <th class="table-col-action nosort">@T("Common.Action")</th>
                        <th class="table-col-seq nosort">@T("Production.Process_Seq")</th>
                        <th>@T("QA.Functionfactory")</th>
                        <th>@T("QA.Processname")</th>
                        <th>@T("Production.CTSecond")</th>
                        <th>@T("Production.ManRadio")</th>
                        <th>@T("Production.TargetYield")</th>
                        <th>@T("Production.Capacity_ByHour")</th>
                        <th>@T("Production.Capacity_ByDay")</th>
                        <th>@T("Production.Equip")</th>
                        <th>@T("Production.EquipChange")</th>
                        <th>@T("Production.FixedOP")</th>
                        <th>@T("Production.OPChange")</th>
                        <th>@T("Production.MonitorRatioRule")</th>
                        <th>@T("Production.MonitorRatioRatio")</th>
                        <th>@T("Production.MonitorChange")</th>
                        <th>@T("Production.TechnicalRatio")</th>
                        <th>@T("Production.TechnicalChange")</th>
                        <th>@T("Production.BindBom")</th>
                        <th>@T("Production.Other")</th>
                        <th>@T("Production.Remark")</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th class="table-col-action nosort">@T("Common.Action")</th>
                        <th class="table-col-seq nosort">@T("Production.Process_Seq")</th>
                        <th>@T("QA.Functionfactory")</th>
                        <th>@T("QA.Processname")</th>
                        <th>@T("Production.CTSecond")</th>
                        <th>@T("Production.ManRadio")</th>
                        <th>@T("Production.TargetYield")</th>
                        <th>@T("Production.Capacity_ByHour")</th>
                        <th>@T("Production.Capacity_ByDay")</th>
                        <th>@T("Production.Equip")</th>
                        <th>@T("Production.EquipChange")</th>
                        <th>@T("Production.FixedOP")</th>
                        <th>@T("Production.OPChange")</th>
                        <th>@T("Production.MonitorRatioRule")</th>
                        <th>@T("Production.MonitorRatioRatio")</th>
                        <th>@T("Production.MonitorChange")</th>
                        <th>@T("Production.TechnicalRatio")</th>
                        <th>@T("Production.TechnicalChange")</th>
                        <th>@T("Production.BindBom")</th>
                        <th>@T("Production.Other")</th>
                        <th>@T("Production.Remark")</th>
                    </tr>
                </tfoot>
            </table>
            <div id="page" class="row" style="display:none;">

            </div>
            <div class="row">
                <!--次標題與Search keyword-->
                <div class="col-md-12 col-lg-9">
                    
                </div><!-- /col-次標題與Search keyword -->
                <!--col-右方搜尋與功能按鈕列-->
                <div class="col-md-12 search-field col-lg-3">
                    <a class="btn btn-primary btn-sm" role="button" data-toggle="modal" onclick="javascript: self.location = document.referrer;"> @T("Common.Back")</a>
                    <a class="btn btn-primary btn-sm" role="button" data-toggle="modal" id="btn-submit-inner">
                        @T("QA.Submit")
                    </a>
                </div>
            </div><!--/次標題 與 搜尋-->
        </div><!--/表格-->
    </div><!-- / 內容 表格列 -->
    


</section><!-- /.content -->

@section ViewModals{
    <!-- Modal -->
<div class="modal fade" id="js_view_modal" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">@T("Production.SetConfigProcess")</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal clearfix">
                    <div class="col-sm-5">
                        <div class="form-group">
                            <label class="col-sm-5 control-label" style="text-align:left">@T("Production.CurrentProcess")</label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control-static" id="js_Flowchart_Detail_UID" hidden="hidden"/>
                                <input type="text" class="form-control-static" id="js_ProcessName"  />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-7">
                        <div class="form-group">
                            <label class="col-sm-4 control-label text-left">@T("Production.ProcessRange")</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control-static" id="js_RangeNumber" value=" ">
                            </div>
                            <div class="col-sm-2">
                                <button class="btn btn-primary btn-sm" type="button" id="js_search"> @T("QA.Inquire")</button>
                            </div>
                        </div>
                    </div>
                </form>
                <table class="table table-condensed" id="js_range_datatable">
                    <thead>
                        <tr>
                            <th class="padding-l-5-i">@T("Production.Monitor")</th>
                            <th class="padding-l-5-i">@T("Production.Technical")</th>
                            <th class="padding-l-5-i">@T("Production.Process_Seq")</th>
                            <th class="padding-l-5-i">@T("QA.Processname")</th>
                        </tr>
                    </thead>
                </table>
                
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary btn-sm" data-dismiss="modal" id="js_commit"> @T("Common.Sure")</button>
                <button class="btn btn-primary btn-sm" data-dismiss="modal" id="js_cancel">@T("Common.Cancel")</button>
            </div>
        </div>
    </div>
</div>

        <!-- Edit Modal -->
<div class="modal fade" id="js_edit_modal" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">@T("Common.Edit")</h4>
            </div>
            <form id="js_form_org_edit" class="form-horizontal clearfix">
                <div class="modal-body">
                    <div class="form-group col-xs-12 col-md-6 col-lg-6">
                        <input type="hidden" name="Flowchart_Detail_ME_UID" id="Modify_Flowchart_Detail_ME_UID" value=""/>
                        <input type="hidden" name="Flowchart_Detail_IE_UID" id="Modify_Flowchart_Detail_IE_UID" value="" />

                        <label class="col-sm-4 control-label" for="js_s_edit_Process">@T("Production.JustProcess")</label>
                        <div class="col-sm-8">
                            <input type="text" name="Process" disabled="disabled" class="form-control input-sm" id="js_s_edit_Process">
                        </div>
                    </div>

                    <div class="form-group col-xs-12 col-md-6 col-lg-6">
                        <label class="col-sm-4 control-label" for="Modify_VariationEquipment_RequstQty">@T("Production.EquipChange")</label>
                        <div class="col-sm-8">
                            <input type="text" name="VariationEquipment_RequstQty" class="form-control input-sm" id="Modify_VariationEquipment_RequstQty" data-rule-digits="true" data-msg-digits="@T("QA.Naturalnumber")" placeholder="@T("Production.EquipChange")">
                        </div>
                    </div>
                    <div class="form-group col-xs-12 col-md-6 col-lg-6">
                        <label class="col-sm-4 control-label" for="Modify_RegularOP_Qty">@T("Production.FixedOP")</label>
                        <div class="col-sm-8">
                            <input type="text" name="RegularOP_Qty" class="form-control input-sm" id="Modify_RegularOP_Qty" data-rule-digits="true" data-msg-digits="@T("QA.Naturalnumber")" placeholder="@T("Production.FixedOP")">
                        </div>
                    </div>

                    <div class="form-group col-xs-12 col-md-6 col-lg-6">
                        <label class="col-sm-4 control-label" for="Modify_VariationOP_Qty">@T("Production.OPChange")</label>
                        <div class="col-sm-8">
                            <input type="text" name="VariationOP_Qty" class="form-control input-sm" id="Modify_VariationOP_Qty" data-rule-digits="true" data-msg-digits="@T("QA.Naturalnumber")" placeholder="@T("Production.OPChange")">
                        </div>
                    </div>

                    <div class="form-group  col-lg-12">
                        <div class="form-group">
                            <label class="col-sm-2 control-label" for="Modify_Match_Rule">@T("Production.MonitorRatioRule")</label>
                            <div class="col-sm-10">
                                 <select class="form-control input-sm" id="Modify_Match_Rule" name="Match_Rule"></select>
                            </div>
                        </div>
                    </div>
                    <div class="form-group  col-lg-12">
                        <div class="form-group">
                            <label class="col-sm-2 control-label" for="Modify_Monitor_Match_Raito">@T("Production.MonitorRatioRatio")</label>
                            <div class="col-sm-10">
                                <input type="text" name="Monitor_Match_Raito" class="form-control input-sm" id="Modify_Monitor_Match_Raito" placeholder="@T("Production.MonitorRatioRatio")">
                            </div>
                        </div>
                    </div>
                    <div class="form-group  col-lg-12">
                        <div class="form-group">
                            <label class="col-sm-2 control-label" for="Modify_VariableMonitor__Qty">@T("Production.MonitorChange")</label>
                            <div class="col-sm-10">
                                <input type="text" name="VariableMonitor__Qty" class="form-control input-sm" id="Modify_VariableMonitor__Qty" placeholder="@T("Production.MonitorChange")">
                            </div>
                        </div>
                    </div>


                    <div class="form-group  col-lg-12">
                        <div class="form-group">
                            <label class="col-sm-2 control-label" for="Modify_Technician_Match_Raito">@T("Production.TechnicalRatio")</label>
                            <div class="col-sm-10">
                                <input type="text" name="Technician_Match_Raito" class="form-control input-sm" id="Modify_Technician_Match_Raito" placeholder="@T("Production.TechnicalRatio")">
                            </div>
                        </div>
                    </div>

                    <div class="form-group  col-lg-12">
                        <div class="form-group">
                            <label class="col-sm-2 control-label" for="Modify_VariableTechnician__Qty">@T("Production.TechnicalChange")</label>
                            <div class="col-sm-10">
                                <input type="text" name="VariableTechnician__Qty" class="form-control input-sm" id="Modify_VariableTechnician__Qty" placeholder="@T("Production.TechnicalChange")">
                            </div>
                        </div>
                    </div>

                    <div class="form-group col-xs-12 col-md-6 col-lg-6">
                        <label class="col-sm-4 control-label" for="Modify_MaterialKeeper_Qty">@T("Production.BindBom")</label>
                        <div class="col-sm-8">
                            <input type="text" name="MaterialKeeper_Qty" class="form-control input-sm" id="Modify_MaterialKeeper_Qty" data-rule-digits="true" data-msg-digits="@T("QA.Naturalnumber")" placeholder="@T("Production.BindBom")">
                        </div>
                    </div>

                    <div class="form-group col-xs-12 col-md-6 col-lg-6">
                        <label class="col-sm-4 control-label" for="Modify_Others_Qty">@T("Production.Other")</label>
                        <div class="col-sm-8">
                            <input type="text" name="Others_Qty" class="form-control input-sm" id="Modify_Others_Qty" data-rule-digits="true" data-msg-digits="@T("QA.Naturalnumber")" placeholder="@T("Production.Other")">
                        </div>
                    </div>
                    <div class="form-group col-xs-12 col-md-6 col-lg-6">
                        <label class="col-sm-4 control-label" for="Modify_Note">@T("Production.Remark")</label>
                        <div class="col-sm-8">
                            <input type="text" name="Notes" class="form-control input-sm" id="Modify_Note" data-rule-digits="true" placeholder="@T("Production.Remark")">
                        </div>
                    </div>
                </div>
            </form>
            <div class="modal-footer">
                <button class="btn btn-primary btn-sm" data-dismiss="modal"><i class="fa fa-times"></i> @T("Common.Cancel")</button>
                <button type="button" class="btn btn-primary btn-sm" id="js_btn_save"><i class="fa fa-save"></i> @T("Common.Save")</button>
            </div>
        </div>
    </div>
</div>



}


@section ViewScripts{
    <script type="text/javascript">
        $(function () {
            var FlowChartsForIE = (function () {
                var urls = {
                    QueryFlowCharts: '@Url.Action("QueryFlowCharts", "ProductionPlanning")',
                    QueryFlowChartByRangeNumber: '@Url.Action("QueryFlowChartByRangeNumber", "ProductionPlanning")',
                    SaveMappingData: '@Url.Action("SaveMappingData", "ProductionPlanning")',
                    SaveIEFlowchartData: '@Url.Action("SaveIEFlowchartData", "ProductionPlanning")',
                    UpdateIEFlowchartData: '@Url.Action("UpdateIEFlowchartData", "ProductionPlanning")',
                    QueryFlowChartByFlowchart_Detail_ME_UID: '@Url.Action("QueryFlowChartByFlowchart_Detail_ME_UID", "ProductionPlanning")'
                };

                var functionDatatable = null;
                var FlowchartDatatable = null;

            var columns = [
                {
                    data:null,
                    createdCell: function (td, cellData, rowData, row, col) {

                        var result = '<button type="button" class="btn btn-default btn-xs" rel="action-popover">' +
                                    '<i class="fa fa-reorder text-info"></i>' +
                                    '</button>' +
                                    '<div class="hidden popover-content">';

                        var htmlView = '<button type="button" class="btn btn-default btn-sm js-grid-view" data-process="' + rowData.Process + '" data-id="' + rowData.Flowchart_Detail_ME_UID + '">@ViewBag.SetConfigProcess</button></br>' +
                            '  <button type="button" class="btn btn-default btn-sm js-grid-edit" data-process="' + rowData.Process + '" data-id="' + rowData.Flowchart_Detail_ME_UID + '">@ViewBag.Edit</button>'+
                            '  <input type="text" class="form-control input-xs text-center" style="display:none;"   name="Flowchart_Detail_ME_UID"  value="' + rowData.Flowchart_Detail_ME_UID + '">' +
                            '  <input type="text" class="form-control input-xs text-center" style="display:none;"   name="Flowchart_Detail_IE_UID"  value="' + rowData.Flowchart_Detail_IE_UID + '">';

                        result = result + htmlView + '</div>';
                        $(td).html(result);
                    },
                    className: "text-center"
                }, {
                    data: "Process_Seq",
                    className: "min-col-xs"
                }, {
                    data: "Funplant",
                    className: "min-col-xs"
                }, {
                    data: "Process",
                    className: "min-col-xs"
                }
                ,
                {
                    data: "Total_Cycletime",
                    className: "min-col-xs text-right"
                }, {
                    data: "Manpower_Ratio",
                    className: "min-col-xs text-right"
                }, {
                    data: "Estimate_Yield",
                    className: "min-col-xs text-right"
                }, {
                    data: "Capacity_ByHour",
                    className: "min-col-xs text-right"
                }, {
                    data: "Capacity_ByDay",
                    className: "min-col-xs text-right"
                }, {
                    data: "Equipment_RequstQty",
                    className: "min-col-xs text-right"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('<input type="text" class="form-control input-xs text-right" style="width:85%" name="VariationEquipment_RequstQty" value="' + rowData.VariationEquipment_RequstQty + '">');
                        else
                            $(td).html('<input type="text" class="form-control input-xs text-right" style="width:85%" name="VariationEquipment_RequstQty"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('  <input type="text" class="form-control input-xs text-right" style="width:85%"   name="RegularOP_Qty"  value="' + rowData.RegularOP_Qty + '">');
                        else
                            $(td).html('  <input type="text" class="form-control input-xs text-right"  name="RegularOP_Qty" style="width:85%"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('  <input type="text" class="form-control input-xs text-right" style="width:85%"   name="VariationOP_Qty"  value="' + rowData.VariationOP_Qty + '">');
                        else
                            $(td).html('  <input type="text" class="form-control input-xs text-right"  name="VariationOP_Qty" style="width:85%"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        var result;
                        var readOnlyHtml = '<select name="Match_Rule" class="form-control input-sm Match_Rule_uid"></select>';
                        if (rowData.Match_RuleVM == 1) {
                            readOnlyHtml = $(readOnlyHtml).append('<option value="1" selected="selected">@ViewBag.MachineRadio</option>');
                            readOnlyHtml = $(readOnlyHtml).append('<option value="2">@ViewBag.PeopleRadio</option>');
                        }
                        else if (rowData.Match_RuleVM == 2) {
                            readOnlyHtml = $(readOnlyHtml).append('<option value="1">@ViewBag.MachineRadio</option>');
                            readOnlyHtml = $(readOnlyHtml).append('<option value="2" selected="selected">@ViewBag.PeopleRadio</option>');
                        }
                        else
                        {
                            readOnlyHtml = $(readOnlyHtml).append('<option value="1">@ViewBag.MachineRadio</option>');
                            readOnlyHtml = $(readOnlyHtml).append('<option value="2">@ViewBag.PeopleRadio</option>');
                        }

                        //if (rowData.Flowchart_Detail_IE_UID != null) {
                        //    result = $(readOnlyHtml).attr("Disabled", true);
                        //}
                        result = readOnlyHtml[0].outerHTML;
                        $(td).html(result);
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('  <input type="text" style="width:85%" class="form-control input-xs text-right"    name="Monitor_Match_Raito"  value="' + rowData.SquadLeader_Raito + '">');
                        else
                            $(td).html('  <input type="text" style="width:85%" class="form-control input-xs text-right"  name="Monitor_Match_Raito"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('  <input type="text" style="width:85%" class="form-control input-xs text-right"   name="VariableMonitor__Qty"  value="' + rowData.SquadLeader_Variable_Qty + '">');
                        else
                            $(td).html('  <input type="text" style="width:85%" class="form-control input-xs text-right"  name="VariableMonitor__Qty"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('  <input type="text" style="width:85%" class="form-control input-xs text-right"    name="Technician_Match_Raito"  value="' + rowData.Technician_Raito + '">');
                        else
                            $(td).html('  <input type="text" style="width:85%" class="form-control input-xs text-right"  name="Technician_Match_Raito"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('<input type="text" style="width:85%" class="form-control input-xs text-right"  name="VariableTechnician__Qty" value="' + rowData.Technician_Variable_Qty + '">');
                        else
                            $(td).html('<input type="text" style="width:85%" class="form-control input-xs text-right" name="VariableTechnician__Qty"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('<input type="text" style="width:85%" class="form-control input-xs text-right"  name="MaterialKeeper_Qty" value="' + rowData.MaterialKeeper_Qty + '">');
                        else
                            $(td).html('<input type="text" style="width:85%" class="form-control input-xs text-right" name="MaterialKeeper_Qty"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Flowchart_Detail_IE_UID != null)
                            $(td).html('<input type="text" style="width:85%" class="form-control input-xs text-right"  name="Others_Qty" value="' + rowData.Others_Qty + '">');
                        else
                            $(td).html('<input type="text" style="width:85%" class="form-control input-xs text-right" name="Others_Qty"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.Notes != null)
                            $(td).html('<input type="text" style="width:85%" class="form-control input-xs text-right"  name="Notes" value="' + rowData.Notes + '">');
                        else
                            $(td).html('<input type="text" style="width:85%" class="form-control input-xs text-right" name="Notes"  value="' + "" + '">');
                    },
                    className: "min-col-xs"
                }
            ];

            var rangeColumns = [
                {

                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        var result;
                        if (rowData.MonitorFlag)
                        {
                            result = '<input type="checkbox" name="MonitorCheckbox" class="js-checkbox-item table-col-checkbox"  checked="checked">'
                        }
                        else {
                            result = '<input type="checkbox" name="MonitorCheckbox" class="js-checkbox-item table-col-checkbox">'
                        }
                        $(td).html(result+
                               '<input type="text" style="display:none;" name="Flowchart_Detail_ME_UID"  value="' + rowData.Flowchart_Detail_ME_UID + '">' +
                               '<input type="text" style="display:none;" name="Monitor_Staff_UID"  value="' + rowData.Monitor_Staff_UID + '">');
                    },
                    className: "text-center min-col-xs"
                }, {
                    data: null,
                    createdCell: function (td, cellData, rowData, row, col) {
                        if (rowData.TechnicianFlag) {
                            result = '<input type="checkbox" name="TechnicianCheckbox" class="js-checkbox-item table-col-checkbox"  checked="checked">'
                        }
                        else
                        {
                            result = '<input type="checkbox" name="TechnicianCheckbox" class="js-checkbox-item table-col-checkbox">'
                        }
                        $(td).html(result +
                             '<input type="text" style="display:none;" name="Technician_Staff_UID"  value="' + rowData.Technician_Staff_UID + '">');
                    },
                    className: "text-center min-col-xs"
                }, {
                    data: "Process_Seq",
                    className: "text-center min-col-xs",
                }, {
                    data: "Process",
                    className: "text-center min-col-xs",
                }];

            var _getParams = function () {
                var FlowChartMasterUID = $('#js_inputData_FlowChart_Master_UID').val();
                var result = {};
                result["FlowChart_Master_UID"] = FlowChartMasterUID;

                return result;
            };

            var _queryFLS = function (firstLoad) {
                var config = {
                    pageId: "#page",
                    tableId: "#js_Flowchart_Detail_Data",
                    remoteUrl: urls.QueryFlowCharts,
                    searchParams: _getParams(),
                    tableOptions: {
                        scrollX: true,
                        autoWidth: true,
                        scrollY: 500,
                        columns: columns
                    }
                };
                if (!firstLoad) {
                    $('#page').page('destroy');
                    PDMS.Utility.Criteria.Build();
                }
                PDMS.Utility.Pages.Set(config);
            };

            return {
                urls: urls,
                Init: function () {
                    PDMS.Utility.Criteria.Init();
                    _queryFLS(true);
                },
                QueryFLCharts: function () {
                    _queryFLS(false);
                },
                GetFunctionDatatable: function () {
                    if (functionDatatable == null) {
                        functionDatatable = $('#js_range_datatable').DataTable({
                            paging: false,
                            searching: false,
                            ordering: false,
                            retrieve: true,
                            columns: rangeColumns,
                        });
                    }
                    return functionDatatable;
                },
                GetFlowchartDatatable: function () {

                    if (FlowchartDatatable == null) {

                        FlowchartDatatable = $('#js_Flowchart_Detail_Data').DataTable({
                            paging: false,
                            searching: false,
                            ordering: false,
                            retrieve: true,
                            columns: columns,
                        });
                    }
                    return FlowchartDatatable;
                },
                EditColumns: { Columns:rangeColumns}
            }

            })();
            FlowChartsForIE.Init();

            $('#js_search').click(function () {
                var url = FlowChartsForIE.urls.QueryFlowChartByRangeNumber;
                var Flowchart_Detail_ME_UID = $('#js_Flowchart_Detail_UID').val();
                var RangeNumber = $('#js_RangeNumber').val();

                $.get(url, { Flowchart_Detail_ME_UID: Flowchart_Detail_ME_UID, RangeNumber: RangeNumber }, function (data) {
                    $('#js_range_datatable').DataTable({
                        columns: FlowChartsForIE.EditColumns.Columns,
                        ordering: false,
                        data: data,
                        destroy: true
                    });
                });
            });

            $('#js_commit').click(function () {
                var dataTable = FlowChartsForIE.GetFunctionDatatable();
                var DataInfo = [];
                var DataInfoValue = {};

                var Flowchart_Detail_ME_UID_Banding = $('#js_Flowchart_Detail_UID').val();
                dataTable
                    .rows()
                    .every(function (rowIdx, tableLoop, rowLoop) {
                        var sub = {};
                        var row = $('#js_range_datatable>tbody>tr').eq(rowIdx);

                        var Flowchart_Detail_ME_UID = $.trim(row.find('input[name=Flowchart_Detail_ME_UID]').val());
                        var Flowchart_Detail_IE_UID = $.trim(row.find('input[name=Flowchart_Detail_IE_UID]').val());

                        var Monitor_Staff_UID = $.trim(row.find('input[name=Monitor_Staff_UID]').val());
                        var Technician_Staff_UID = $.trim(row.find('input[name=Technician_Staff_UID]').val());

                        if (row.find('input[name=MonitorCheckbox]').is(':checked'))
                        {
                            MonitorCheckbox = true;
                        }
                        else {
                            MonitorCheckbox = false;
                        }

                        if (row.find('input[name=TechnicianCheckbox]').is(':checked')) {
                            TechnicianCheckbox = true;
                        }
                        else {
                            TechnicianCheckbox = false;
                        }


                        var sub = {};
                        sub["Flowchart_Detail_ME_UID_Banding"] = Flowchart_Detail_ME_UID_Banding;
                        sub["Flowchart_Detail_ME_UID"] = Flowchart_Detail_ME_UID;
                        if (Flowchart_Detail_IE_UID != null) {
                            sub["Flowchart_Detail_IE_UID"] = Flowchart_Detail_IE_UID;
                        }
                        else
                        {
                            sub["Flowchart_Detail_IE_UID"] = 0;
                        }
                        if (Technician_Staff_UID != null&&Technician_Staff_UID !="null") {
                            sub["Technician_Staff_UID"] = Technician_Staff_UID;
                        }
                        else {
                            sub["Technician_Staff_UID"] = 0;
                        }
                        if (Monitor_Staff_UID != null && Monitor_Staff_UID != "null") {
                            sub["Monitor_Staff_UID"] = Monitor_Staff_UID;
                        }
                        else {
                            sub["Monitor_Staff_UID"] = 0;
                        }
                        if (MonitorCheckbox){
                            sub["MonitorFlag"] = true;
                        }
                        else {
                            sub["MonitorFlag"] = false;
                        }

                        if (TechnicianCheckbox) {
                            sub["TechnicianFlag"] = true;
                        }
                        else {
                            sub["TechnicianFlag"] = false;
                        }
                        DataInfo.push(sub);
                    });

                DataInfoValue.DataList = DataInfo;
                if (DataInfo.length > 0) {
                    $.post(FlowChartsForIE.urls.SaveMappingData, { jsonWithProduct: JSON.stringify(DataInfoValue) }, function (data) {
                            if (data == 'Success') {
                                PDMS.Utility.MessageBox.info("@ViewBag.Submittedsuccessfully");
                                FlowChartsForIE.QueryFLCharts();
                            } else {
                                PDMS.Utility.MessageBox.error(data);
                                $('#errorModal').on('click', '.btn-default', function () {
                                    FlowChartsForIE.QueryFLCharts();
                                });
                            }
                        });
                }
            });

            $('#js_view_modal').on('hidden.bs.modal', function (e) {

                $('#js_view_modal').find('input').val('');
            });

            $('body').on('click', '.js-grid-view', function () {
                var Flowchart_Detail_ME_UID = $(this).attr('data-id');
                var ProcessName = $(this).attr('data-process');
                $('#js_Flowchart_Detail_UID').val(Flowchart_Detail_ME_UID);
                $('#js_ProcessName').val(ProcessName);
                var url = FlowChartsForIE.urls.QueryFlowChartByRangeNumber;

                $.get(url, { Flowchart_Detail_ME_UID: Flowchart_Detail_ME_UID, RangeNumber: 0 }, function (data) {
                    $('#js_range_datatable').DataTable({
                        columns: FlowChartsForIE.EditColumns.Columns,
                        ordering: false,
                        data: data,
                        destroy: true
                    });

                    $('#js_view_modal').modal("show");
                });
            });

            $('body').on('click', '.js-grid-edit', function () {
                var Flowchart_Detail_ME_UID = $(this).attr('data-id');
                var ProcessName = $(this).attr('data-process');
                $('#Modify_Flowchart_Detail_ME_UID').val(Flowchart_Detail_ME_UID);

                var url = FlowChartsForIE.urls.QueryFlowChartByFlowchart_Detail_ME_UID;
                $.get(url, { Flowchart_Detail_ME_UID: Flowchart_Detail_ME_UID }, function (data) {

                    $('#Modify_Flowchart_Detail_IE_UID').val(data.Flowchart_Detail_IE_UID);
                    $('#Modify_VariationEquipment_RequstQty').val(data.VariationEquipment_RequstQty);
                    $('#Modify_VariationOP_Qty').val(data.VariationOP_Qty);
                    $('#Modify_RegularOP_Qty').val(data.RegularOP_Qty);
                    $('#Modify_MaterialKeeper_Qty').val(data.MaterialKeeper_Qty);
                    $('#Modify_Others_Qty').val(data.Others_Qty);
                    $('#js_s_edit_Process').val(data.Process);
                    $("#Modify_Match_Rule").empty();

                    $("<option></option>").val(1).text("@ViewBag.MachineRadio").appendTo($("#Modify_Match_Rule"));
                    $("<option></option>").val(2).text("@ViewBag.PeopleRadio").appendTo($("#Modify_Match_Rule"));
                    if (data.Match_Rule == 1)
                    {
                        $("#Modify_Match_Rule option[text='@ViewBag.MachineRadio']").attr("selected", true);
                    }
                    else
                    {
                        $("#Modify_Match_Rule option[text='@ViewBag.PeopleRadio']").attr("selected", true);
                    }

                    $('#Modify_Monitor_Match_Raito').val(data.SquadLeader_Raito);
                    $('#Modify_VariableMonitor__Qty').val(data.SquadLeader_Variable_Qty);
                    $('#Modify_Technician_Match_Raito').val(data.Technician_Raito);
                    $('#Modify_VariableTechnician__Qty').val(data.Technician_Variable_Qty);
                    $('#Modify_Note').val(data.Notes);
                    $('#js_edit_modal').modal("show");
                });
            });

            //保存资料按钮
            $('#btn-submit-inner').click('click', function () {
                $.blockUI({ message: "<h1>@ViewBag.Pleasewait</h1>" });
                var dataTable = FlowChartsForIE.GetFlowchartDatatable();
                var FlowhcartValue = {};
                var FlowhcartInfo = [];
                var flag = true;
                // 首先检查用户输入的数字是否为 自然数
                function checkRate(input) {
                    if (!flag)
                    { return; }
                    var re = /^[0-9]+[0-9]*]*$/;

                    if (!re.test(input)) {
                        PDMS.Utility.MessageBox.error("@ViewBag.Naturalnumber");
                        flag = false;
                    }
                }
                function checkxiaoshu(input) {
                    if (!flag)
                    { return; }
                    var re = /^[0-9]+[0-9]*]*$/;
                    if (!re.test(input)) {
                        re1 = /^-?\d+\.\d+$/;

                        if (!re1.test(input)) {
                            PDMS.Utility.MessageBox.error("@ViewBag.Naturalnumber");
                            flag = false;
                        }
                    }

                }
                dataTable
                    .rows()
                    .every(function (rowIdx, tableLoop, rowLoop) {
                        var sub = {};
                        var row = $('#js_Flowchart_Detail_Data>tbody>tr').eq(rowIdx);

                        var Flowchart_Detail_ME_UID = $.trim(row.find('input[name=Flowchart_Detail_ME_UID]').val());
                        var Flowchart_Detail_IE_UID = $.trim(row.find('input[name=Flowchart_Detail_IE_UID]').val());
                        var VariationEquipment_RequstQty = $.trim(row.find('input[name=VariationEquipment_RequstQty]').val());
                        var RegularOP_Qty = $.trim(row.find('input[name=RegularOP_Qty]').val());
                        var VariationOP_Qty = $.trim(row.find('input[name=VariationOP_Qty]').val());
                        var Match_Rule = $.trim(row.find('.Match_Rule_uid option:selected').val());
                        var Monitor_Match_Raito = $.trim(row.find('input[name=Monitor_Match_Raito]').val());
                        var VariableMonitor__Qty = $.trim(row.find('input[name=VariableMonitor__Qty]').val());
                        var Technician_Match_Raito = $.trim(row.find('input[name=Technician_Match_Raito]').val());
                        var VariableTechnician__Qty = $.trim(row.find('input[name=VariableTechnician__Qty]').val());
                        var MaterialKeeper_Qty = $.trim(row.find('input[name=MaterialKeeper_Qty]').val());
                        var Others_Qty = $.trim(row.find('input[name=Others_Qty]').val());
                        var Notes = $.trim(row.find('input[name=Notes]').val());


                        // 用户未输入值时候，系统默认为"0"，输入值提交时 需要验证用户输入的值是否为自然数。
                        if (VariationEquipment_RequstQty == "") {
                            VariationEquipment_RequstQty = 0;
                        }
                        else {
                            checkRate(VariationEquipment_RequstQty);
                        }
                        if (Monitor_Match_Raito == "") {
                            Monitor_Match_Raito = 0;
                        }
                        else {
                            checkxiaoshu(Monitor_Match_Raito);
                        }
                        if (Technician_Match_Raito == "") {
                            Technician_Match_Raito = 0;
                        }
                        else {
                            checkxiaoshu(Technician_Match_Raito);
                        }
                        if (RegularOP_Qty == "") {
                            RegularOP_Qty = 0;
                        }
                        else {
                            checkRate(RegularOP_Qty);
                        }

                        if (VariationOP_Qty == "") {
                            VariationOP_Qty = 0;
                        }
                        else {
                            checkRate(VariationOP_Qty);
                        }

                        if (VariableMonitor__Qty == "") {
                            VariableMonitor__Qty = 0;
                        }
                        else {
                            checkRate(VariableMonitor__Qty);
                        }

                        if (VariableTechnician__Qty == "") {
                            VariableTechnician__Qty = 0;
                        }
                        else {
                            checkRate(VariableTechnician__Qty);
                        }
                        if (MaterialKeeper_Qty == "") {
                            MaterialKeeper_Qty = 0;
                        }
                        else {
                            checkRate(MaterialKeeper_Qty);
                        }
                        if (Others_Qty == "") {
                            Others_Qty = 0;
                        }
                        else {
                            checkRate(Others_Qty);
                        }
                        if (Flowchart_Detail_IE_UID == "null")
                        {
                            Flowchart_Detail_IE_UID = 0;
                        }

                        sub["Flowchart_Detail_ME_UID"] = Flowchart_Detail_ME_UID;
                        sub["Flowchart_Detail_IE_UID"] = Flowchart_Detail_IE_UID;
                        sub["VariationEquipment_RequstQty"] = VariationEquipment_RequstQty;
                        sub["RegularOP_Qty"] = RegularOP_Qty;
                        sub["VariationOP_Qty"] = VariationOP_Qty;
                        sub["Match_Rule"] = Match_Rule;
                        sub["Monitor_Match_Raito"] = Monitor_Match_Raito;
                        sub["VariableMonitor__Qty"] = VariableMonitor__Qty;
                        sub["Technician_Match_Raito"] = Technician_Match_Raito;
                        sub["VariableTechnician__Qty"] = VariableTechnician__Qty;
                        sub["MaterialKeeper_Qty"] = MaterialKeeper_Qty;
                        sub["Others_Qty"] = Others_Qty;
                        sub["Notes"] = Notes;
                        FlowhcartInfo.push(sub);
                    });
                FlowhcartValue.DataList = FlowhcartInfo;

                if (FlowhcartInfo.length > 0) {
                    if (flag) {
                        $.post(FlowChartsForIE.urls.SaveIEFlowchartData, { jsonWithProduct: JSON.stringify(FlowhcartValue) }, function (data) {
                            if (data == 'Success') {
                                PDMS.Utility.MessageBox.info("@ViewBag.Submittedsuccessfully");
                                FlowChartsForIE.QueryFLCharts();
                            } else {
                                PDMS.Utility.MessageBox.error(data);

                                $('#errorModal').on('click', '.btn-default', function () {
                                    FlowChartsForIE.QueryFLCharts();
                                });
                            }
                            $.unblockUI();
                        });
                    }
                }
                else {
                    $.unblockUI();
                    PDMS.Utility.MessageBox.error("@ViewBag.ErrorForBadYieldDetail");
                }

            });



            $('#js_btn_submit').click('click', function () {
                $.blockUI({ message: "<h1>@ViewBag.Pleasewait</h1>" });
                var dataTable = FlowChartsForIE.GetFlowchartDatatable();
                var FlowhcartValue = {};
                var FlowhcartInfo = [];
                var flag = true;
                // 首先检查用户输入的数字是否为 自然数
                function checkRate(input) {
                    if (!flag)
                    { return; }
                    var re = /^[0-9]+[0-9]*]*$/;

                    if (!re.test(input)) {
                        PDMS.Utility.MessageBox.error("@ViewBag.Naturalnumber");
                        flag = false;
                    }
                }
                function checkxiaoshu(input) {
                    if (!flag)
                    { return; }
                    var re = /^[0-9]+[0-9]*]*$/;
                    if (!re.test(input)) {
                        re1 = /^-?\d+\.\d+$/;

                        if (!re1.test(input)) {
                            PDMS.Utility.MessageBox.error("@ViewBag.Naturalnumber");
                            flag = false;
                        }
                    }

                }
                dataTable
                    .rows()
                    .every(function (rowIdx, tableLoop, rowLoop) {
                        var sub = {};
                        var row = $('#js_Flowchart_Detail_Data>tbody>tr').eq(rowIdx);

                        var Flowchart_Detail_ME_UID = $.trim(row.find('input[name=Flowchart_Detail_ME_UID]').val());
                        var Flowchart_Detail_IE_UID = $.trim(row.find('input[name=Flowchart_Detail_IE_UID]').val());
                        var VariationEquipment_RequstQty = $.trim(row.find('input[name=VariationEquipment_RequstQty]').val());
                        var RegularOP_Qty = $.trim(row.find('input[name=RegularOP_Qty]').val());
                        var VariationOP_Qty = $.trim(row.find('input[name=VariationOP_Qty]').val());
                        var Match_Rule = $.trim(row.find('.Match_Rule_uid option:selected').val());
                        var Monitor_Match_Raito = $.trim(row.find('input[name=Monitor_Match_Raito]').val());
                        var VariableMonitor__Qty = $.trim(row.find('input[name=VariableMonitor__Qty]').val());
                        var Technician_Match_Raito = $.trim(row.find('input[name=Technician_Match_Raito]').val());
                        var VariableTechnician__Qty = $.trim(row.find('input[name=VariableTechnician__Qty]').val());
                        var MaterialKeeper_Qty = $.trim(row.find('input[name=MaterialKeeper_Qty]').val());
                        var Others_Qty = $.trim(row.find('input[name=Others_Qty]').val());
                        var Notes = $.trim(row.find('input[name=Notes]').val());


                        // 用户未输入值时候，系统默认为"0"，输入值提交时 需要验证用户输入的值是否为自然数。
                        if (VariationEquipment_RequstQty == "") {
                            VariationEquipment_RequstQty = 0;
                        }
                        else {
                            checkRate(VariationEquipment_RequstQty);
                        }
                        if (Monitor_Match_Raito == "") {
                            Monitor_Match_Raito = 0;
                        }
                        else {
                            checkxiaoshu(Monitor_Match_Raito);
                        }
                        if (Technician_Match_Raito == "") {
                            Technician_Match_Raito = 0;
                        }
                        else {
                            checkxiaoshu(Technician_Match_Raito);
                        }
                        if (RegularOP_Qty == "") {
                            RegularOP_Qty = 0;
                        }
                        else {
                            checkRate(RegularOP_Qty);
                        }

                        if (VariationOP_Qty == "") {
                            VariationOP_Qty = 0;
                        }
                        else {
                            checkRate(VariationOP_Qty);
                        }

                        if (VariableMonitor__Qty == "") {
                            VariableMonitor__Qty = 0;
                        }
                        else {
                            checkRate(VariableMonitor__Qty);
                        }

                        if (VariableTechnician__Qty == "") {
                            VariableTechnician__Qty = 0;
                        }
                        else {
                            checkRate(VariableTechnician__Qty);
                        }
                        if (MaterialKeeper_Qty == "") {
                            MaterialKeeper_Qty = 0;
                        }
                        else {
                            checkRate(MaterialKeeper_Qty);
                        }
                        if (Others_Qty == "") {
                            Others_Qty = 0;
                        }
                        else {
                            checkRate(Others_Qty);
                        }
                        if (Flowchart_Detail_IE_UID == "null") {
                            Flowchart_Detail_IE_UID = 0;
                        }

                        sub["Flowchart_Detail_ME_UID"] = Flowchart_Detail_ME_UID;
                        sub["Flowchart_Detail_IE_UID"] = Flowchart_Detail_IE_UID;
                        sub["VariationEquipment_RequstQty"] = VariationEquipment_RequstQty;
                        sub["RegularOP_Qty"] = RegularOP_Qty;
                        sub["VariationOP_Qty"] = VariationOP_Qty;
                        sub["Match_Rule"] = Match_Rule;
                        sub["Monitor_Match_Raito"] = Monitor_Match_Raito;
                        sub["VariableMonitor__Qty"] = VariableMonitor__Qty;
                        sub["Technician_Match_Raito"] = Technician_Match_Raito;
                        sub["VariableTechnician__Qty"] = VariableTechnician__Qty;
                        sub["MaterialKeeper_Qty"] = MaterialKeeper_Qty;
                        sub["Others_Qty"] = Others_Qty;
                        sub["Notes"] = Notes;
                        FlowhcartInfo.push(sub);
                    });
                FlowhcartValue.DataList = FlowhcartInfo;

                if (FlowhcartInfo.length > 0) {
                    if (flag) {
                        $.post(FlowChartsForIE.urls.SaveIEFlowchartData, { jsonWithProduct: JSON.stringify(FlowhcartValue) }, function (data) {
                            if (data == 'Success') {
                                PDMS.Utility.MessageBox.info("@ViewBag.Submittedsuccessfully");
                                FlowChartsForIE.QueryFLCharts();
                            } else {
                                PDMS.Utility.MessageBox.error(data);

                                $('#errorModal').on('click', '.btn-default', function () {
                                    FlowChartsForIE.QueryFLCharts();
                                });
                            }
                            $.unblockUI();
                        });
                    }
                }
                else {
                    $.unblockUI();
                    PDMS.Utility.MessageBox.error("@ViewBag.ErrorForBadYieldDetail");
                }

                //$.unblockUI();
            });

            //编辑界面 保存资料按钮
            $('#js_btn_save').click('click', function () {
                var FlowhcartValue = {};
                var FlowhcartInfo = [];
                var flag = true;
                // 首先检查用户输入的数字是否为 自然数
                function checkRate(input) {
                    if (!flag)
                    { return; }
                    var re = /^[0-9]+[0-9]*]*$/;

                    if (!re.test(input)) {
                        PDMS.Utility.MessageBox.error("@ViewBag.Naturalnumber");
                        flag = false;
                    }
                }
                function checkxiaoshu(input) {
                    if (!flag)
                    { return; }
                    var re = /^[0-9]+[0-9]*]*$/;
                    if (!re.test(input)) {
                        re1 = /^-?\d+\.\d+$/;

                        if (!re1.test(input)) {
                            PDMS.Utility.MessageBox.error("@ViewBag.Naturalnumber");
                            flag = false;
                        }
                    }

                }
                var sub = {};
                        var Flowchart_Detail_IE_UID = $('#Modify_Flowchart_Detail_IE_UID').val();
                        var VariationEquipment_RequstQty = $('#Modify_VariationEquipment_RequstQty').val();
                        var RegularOP_Qty = $('#Modify_RegularOP_Qty').val();
                        var VariationOP_Qty = $('#Modify_VariationOP_Qty').val();
                        var MaterialKeeper_Qty = $('#Modify_MaterialKeeper_Qty').val();
                        var Others_Qty = $('#Modify_Others_Qty').val();
                        var Match_Rule = $("#Modify_Match_Rule option:selected").val();


                        var Monitor_Match_Raito = $('#Modify_Monitor_Match_Raito').val();
                        var VariableMonitor__Qty = $('#Modify_VariableMonitor__Qty').val();
                        var Technician_Match_Raito = $('#Modify_Technician_Match_Raito').val();
                        var VariableTechnician__Qty = $('#Modify_VariableTechnician__Qty').val();
                        var Notes = $('#Modify_Note').val();



                        // 用户未输入值时候，系统默认为"0"，输入值提交时 需要验证用户输入的值是否为自然数。
                        if (VariationEquipment_RequstQty == "") {
                            VariationEquipment_RequstQty = 0;
                        }
                        else {
                            checkRate(VariationEquipment_RequstQty);
                        }
                        if (Monitor_Match_Raito == "") {
                            Monitor_Match_Raito = 0;
                        }
                        else {
                            checkxiaoshu(Monitor_Match_Raito);
                        }
                        if (Technician_Match_Raito == "") {
                            Technician_Match_Raito = 0;
                        }
                        else {
                            checkxiaoshu(Technician_Match_Raito);
                        }
                        if (RegularOP_Qty == "") {
                            RegularOP_Qty = 0;
                        }
                        else {
                            checkRate(RegularOP_Qty);
                        }

                        if (VariationOP_Qty == "") {
                            VariationOP_Qty = 0;
                        }
                        else {
                            checkRate(VariationOP_Qty);
                        }

                        if (VariableMonitor__Qty == "") {
                            VariableMonitor__Qty = 0;
                        }
                        else {
                            checkRate(VariableMonitor__Qty);
                        }

                        if (VariableTechnician__Qty == "") {
                            VariableTechnician__Qty = 0;
                        }
                        else {
                            checkRate(VariableTechnician__Qty);
                        }
                        if (MaterialKeeper_Qty == "") {
                            MaterialKeeper_Qty = 0;
                        }
                        else {
                            checkRate(MaterialKeeper_Qty);
                        }
                        if (Others_Qty == "") {
                            Others_Qty = 0;
                        }
                        else {
                            checkRate(Others_Qty);
                        }
                        if (Flowchart_Detail_IE_UID == "null") {
                            Flowchart_Detail_IE_UID = 0;
                        }

                        sub["Flowchart_Detail_ME_UID"] = $('#Modify_Flowchart_Detail_ME_UID').val();
                        sub["Flowchart_Detail_IE_UID"] = Flowchart_Detail_IE_UID;
                        sub["VariationEquipment_RequstQty"] = VariationEquipment_RequstQty;
                        sub["RegularOP_Qty"] = RegularOP_Qty;
                        sub["VariationOP_Qty"] = VariationOP_Qty;
                        sub["Match_Rule"] = Match_Rule;
                        sub["SquadLeader_Raito"] = Monitor_Match_Raito;
                        sub["SquadLeader_Variable_Qty"] = VariableMonitor__Qty;
                        sub["Technician_Raito"] = Technician_Match_Raito;
                        sub["Technician_Variable_Qty"] = VariableTechnician__Qty;
                        sub["MaterialKeeper_Qty"] = MaterialKeeper_Qty;
                        sub["Others_Qty"] = Others_Qty;
                        sub["Notes"] = Notes;
                        FlowhcartInfo.push(sub);

                FlowhcartValue.DataList = FlowhcartInfo;

                if (FlowhcartInfo.length > 0) {
                    if (flag) {
                        $.post(FlowChartsForIE.urls.UpdateIEFlowchartData, { jsonWithProduct: JSON.stringify(FlowhcartValue) }, function (data) {
                            if (data == 'Success') {

                                PDMS.Utility.MessageBox.info("@ViewBag.Savesuccessfully");
                                FlowChartsForIE.QueryFLCharts();
                            } else {
                                PDMS.Utility.MessageBox.error(data);

                                $('#errorModal').on('click', '.btn-default', function () {
                                    FlowChartsForIE.QueryFLCharts();
                                });
                            }
                            var $modal = $('#js_edit_modal');
                            $modal.modal('hide');
                        });
                    }
                }
                else {
                    PDMS.Utility.MessageBox.error("@ViewBag.ErrorForBadYieldDetail");
                }



            });

        });
    </script>
}